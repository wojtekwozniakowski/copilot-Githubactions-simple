# GitHub Actions Web App PoC

This repository is a proof-of-concept showing how to build, test, secure, deploy, and release a simple web app fully with GitHub Actions.

## What This PoC Demonstrates

- CI on push/PR/manual dispatch
- Matrix builds (Node 20 and 22)
- Dependency caching (`actions/setup-node` cache)
- Linting, formatting checks, tests, and coverage
- Build metadata injection (commit SHA, run number, build time, environment)
- Artifact publishing (`dist`, `coverage`)
- Pull-request dependency review
- Security audit (`npm audit`) and CodeQL scanning
- GitHub Pages deployment with environments + concurrency controls
- Release workflow with autogenerated notes + bundled artifacts + checksums
- Container image build/publish to GHCR
- Scheduled maintenance workflow (weekly)
- Composite action reuse (`.github/actions/setup-node-project`)

## App Overview

The app is intentionally simple and static, but each deployment includes runtime metadata rendered in the UI.

### Local Run

```bash
npm install
npm run dev
```

### Local Production Build

```bash
npm run build:metadata
npm run build
npm run preview
```

## Workflow Overview

### `ci.yml`

Triggers: push, pull_request, workflow_dispatch

Jobs:

- `quality`: matrix checks (lint, format, test, build)
- `dependency-review`: PR-only dependency risk scan
- `security-audit`: `npm audit --audit-level=high`
- `summarize`: writes outcome to `GITHUB_STEP_SUMMARY`

### `deploy-pages.yml`

Triggers: push to `main`, workflow_dispatch

Deploys `dist` to GitHub Pages using:

- `actions/configure-pages`
- `actions/upload-pages-artifact`
- `actions/deploy-pages`

### `release.yml`

Triggers: tag push (`v*.*.*`) or manual dispatch

Features:

- release tag resolution
- production build
- tarball artifact + SHA256 checksum
- GitHub Release creation with notes
- container build and push to GHCR

### `maintenance.yml`

Triggers: weekly cron + manual dispatch

Runs dependency health checks and writes summary for maintainers.

### `codeql.yml`

Triggers: main push, PR to main, weekly cron

Runs CodeQL analysis for JavaScript.

## Diagrams

See `docs/diagrams.md` for architecture and sequence diagrams.

## Required Repository Settings

1. Enable GitHub Pages source: `GitHub Actions`.
2. Ensure Actions has read/write permissions for workflow runs.
3. If org policy blocks packages, allow `GHCR` publishing for this repo.

## Suggested Demo Script (10-15 min)

1. Push a feature branch and open PR.
2. Show CI matrix, dependency review, and security checks.
3. Merge to `main` and show automatic Pages deployment.
4. Create tag `v0.1.0` and show Release + GHCR image publishing.
5. Open maintenance workflow run history to show scheduled governance.

## Extension Ideas

- Add a reusable workflow shared across multiple repos.
- Add environment protection rules with manual approval for production deploy.
- Add OIDC deployment to AWS/Azure/GCP (no long-lived cloud credentials).
- Add Playwright end-to-end tests with screenshots as artifacts.
- Add Slack/Teams notifications with workflow run links.
- Add semantic versioning and automated changelog generation.

## Key Files

- App: `src/index.html`, `src/main.js`, `src/health.js`
- Tests: `tests/health.test.js`
- Metadata script: `scripts/generate-build-metadata.mjs`
- Composite action: `.github/actions/setup-node-project/action.yml`
- Workflows: `.github/workflows/*.yml`
- Diagrams: `docs/diagrams.md`

## Notes

- This PoC uses `npm install` in workflows for flexibility. For stricter reproducibility, commit `package-lock.json` and switch to `npm ci`.
- Container publishing uses `secrets.GITHUB_TOKEN` and pushes to `ghcr.io/<owner>/github-actions-webapp-poc`.
